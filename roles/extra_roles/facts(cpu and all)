- name: Gather and save system facts to CSV
  hosts: all
  tasks:
    - name: Gather facts
      setup:

    - name: Create CSV content
      set_fact:
        csv_content: |
          CPU Model, {{ ansible_processor[0] }}
          Total Memory, {{ ansible_memtotal_mb }} MB
          Disk Info, {{ ansible_mounts | map(attribute='mount') | join('; ') }}

    - name: Save facts to CSV file
      copy:
        content: "{{ csv_content }}"
        dest: "{{ playbook_dir }}/system_facts.csv"
